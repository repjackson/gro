template(name='home')
    .ui.stackable.grid
        .sixteen.wide.left.aligned.column.seg
            unless picked_tags
                .ui.center.aligned.basic.segment.large_search
                    .ui.icon.massive.input
                        if is_loading
                            i.yin.yang.loading.large.icon
                        else
                            if nsfw_mode
                                i.large.fire.icon
                            else
                                i.yin.yang.large.icon
                        input.search_tag(type='text' value=query autofocus='' placeholder='')
                    .ui.hidden.divider
                    +tag_select icon='food' tag='food'
                    +tag_select icon='dna' tag='biology'
                    +tag_select icon='heart' tag='love'
                    +tag_select icon='moon' tag='tarot'
                    +tag_select icon='dog' tag='dog'
                    +tag_select icon='tv' tag='tv'
                    +tag_select icon='leaf' tag='environment'
            if picked_tags
                .ui.left.icon.large.transparent.input
                    if is_loading
                        i.yin.yang.loading.large.icon
                    else
                        if nsfw_mode
                            i.large.fire.icon
                        else
                            if session_is 'simple'
                                i.sliders.horizontal.grey.link.icon.simple_off(title='simple mode')
                            unless session_is 'simple'
                                i.sliders.horizontal.large.black.link.icon.simple_on(title='make advanced')
                    input.search_tag(type='text' value=query autofocus='' placeholder="#{counter}")
                if many_tags
                    a#clear_tags
                        i.remove.link.icon
                each picked_tags
                    +unpick_tag
            |&nbsp;
            // unless simple
            //     i.fire.icon
            //     i.clock.icon
            //     i.chevron.down.icon
            //     i.chevron.right.icon
            //     i.chevron.left.icon
           
           
            // div
            each result_tags
                +tag_picker
            .ui.hidden.divider
            .ui.four.column.centered.stackable.grid.scrollig.pushed
                if alphas.count
                    .smallscroll
                        .column
                            +alpha
                each posts
                    +post_card_small
                
                
                
template(name='tag_picker')
    // a.ui.large.image.rounded.label.zoomer.pointer.pick_tag.pick_term(href='#' title="#{count} results" class="#{picker_class} #{thinking_class}")
    button.ui.grey.large.tertiary.button.zoomer.pick_tag(title="#{count} results" class="#{picker_class} #{thinking_class}")
        if term
            if term.watson.metadata.image
                img.ui.avatar.image.superzoom(src=term.watson.metadata.image )    
        strong #{name}
        // if in_dev
        //     small #{count}
            
template(name='unpick_tag')
    button.unpick_tag.ui.black.compact.large.secondary.button.invert
        if term
            if term.watson.metadata.image
                img.ui.avatar.compact.image.superzoom(src=term.watson.metadata.image)    
        strong #{this}

template(name='flat_tag_picker')
    // a.ui.large.image.rounded.label.zoomer.pointer.pick_tag.pick_term(href='#' title="#{count} results" class="#{picker_class} #{thinking_class}")
    a.ui.compact.small.tertiary.button.zoomer.pick_flat_tag(title="#{count} results" class="#{picker_class} #{thinking_class}")
        if term
            if term.watson.metadata.image
                img.ui.mini.rounded.inline.image.superzoom(src=term.watson.metadata.image )    
        | #{this}
        // if in_dev
        //     small #{count}

        
template(name='tag_select')        
    i.big.link.grey.circular.icon.select_tag(class=icon title=tag)
        
   
template(name='post_card_small')
    .center.aligned.column.smallscroll
        .content.zoomer.card_small.invert
            // a.ui.header.zoomer(href="/#{group}/p/#{_id}") #{title}
            // a.ui.center.aligned.small.header.view_post(href="/#{group}/p/#{_id}" class=emotion_color)
            a.ui.invert.small.header.thin.title.zoomer(href="/p/#{_id}")
                |#{lowered_title}
            
            // a(href="/p/#{_id}" target='_window')
            //     // |!{data.title} #{lowered_title}
            //     |#{lowered_title}
            span.ui.text {{ufrom data.created}}
            .spacer
            if embed
                span.rounded.full.invert
                    |!{embed}
                div
            else if is_image
                a(href="/p/#{_id}" target='_window')
                    img.ui.fluid.rounded.image.zoomer.toggle_view.invert(src="/p/#{_id}")
            else if watson.metadata.image
                img.ui.rounded.image.pointer.invert.call_meta(src=watson.metadata.image)
                    
            else if data.thumbnail_width
                a(href="/p/#{_id}" target='_window')
                    img.ui.fluid.rounded.image.zoomer.invert(src=data.thumbnail)    
            unless simple
                i.chevron.down.icon.dl.invert
                span.invert
                    |#{ups}
                    i.thumbs.up.outline.icon
                    |#{comment_count}
                    i.chat.outline.icon
                with subreddit
                    +flat_tag_picker
                    // .ui.label #{this}
                each five_tags
                    +flat_tag_picker
                a.ui.icon.compact.button(href="https://www.reddit.com#{permalink}" target='_window' title=domain)
                    // |#{domain}
                    i.external.icon
                // div
                .ui.tiny.invert.transparent.left.icon.input
                    i.tag.icon
                    input.add_tag(type='text' placeholder='...')
            .ui.hidden.divider   
            if data.selftext_html
                unless simple
                    span.invert.smallscroll
                        |{{#markdown}} !{data.selftext_html} {{/markdown}}
                        
                        
                        
template(name='alpha')
    each alphas
        if response.queryresult.success
            with response.queryresult
                // .ui.label #{datatypes}
                each split_datatypes
                    .ui.button.compact.buton.select_datatype
                        |#{this}
                // .ui.list
                    // .item success: #{success}
                    // .item error: #{error}
                    // .item numpods: #{numpods}
                    // .item datatypes: #{datatypes}
                    //     each datatypes
                    //         .ui.button
                    //             |#{this}
                    // .item timedout: #{timedout}
                    // .item timedoutpods: #{timedoutpods}
                    // .item timing: #{timing}
                    // .item parsetiming: #{parsetiming}
                    // .item parsetimedout: #{parsetimedout}
                    // .item recalculate: #{recalculate}
                    // .item id: #{id}
                    // .item host: #{host}
                    // .item server: #{server}
                    // .item related: #{related}
                    // .item version: #{version}
                each pods
                    span.say
                        // .ui.small.inline.middle.aligned.header.middled #{title}
                        .ui.small.inline.header #{title}
                        div
                        // .item #{scanner}
                        // .item id #{id}
                        // .item position #{position}
                        // .item error #{error}
                        // .item numsubpods #{numsubpods}
                        // .item subpods
                        // .ui.list
                        each subpods
                            .ui.small.inline.header #{title}
                            img.ui.zoomer.pointer.image.invert.alphatemp(src=img.src)
                            // .item.alphatemp
                            // span.say #{plaintext}
                            // .item title: #{title}
                            // .item primary: #{primary}
                    // each tags
                    //     .ui.label #{this}
                    // .alphatemp voice: #{voice}
                    //   div assumptions": {
                    //     "type": "Clash",
                    //     "word": "time",
                    //     "template": "Assuming \"${word}\" is ${desc1}. Use as ${desc2} instead",
                    //     "count": 4,
                    //     "values": [
                    //       {
                    //         "name": "CalendarWord",
                    //         "desc": " referring to a calendar computation",
                    //         "input": "*C.time-_*CalendarWord-"
                    
                    
            // if many_tags
            //     each alpha_singles
            //         if response.queryresult
            //             +alpha 
