template(name='group_post_view')
    with doc_by_id
        .ui.stackable.grid
            .row 
                .twelve.wide.column
                    a.ui.large.basic.button(href="/g/#{group}")
                        i.chevron.left.icon
                        |#{group}
                    .ui.inline.header.say(class=emotion_color)
                        |#{title}
                    .scrolling
                        if image_link
                            a(href="/g/#{group}")
                                +image_link_view key='image_link' direct=true
                        if image_id
                            a(href="/g/#{group}")
                                img.ui.fluid.rounded.image(src="{{c.url image_id }}" class=currentUser.invert_class)
                        if youtube_id
                            +youtube_view key='youtube_id' label='youtube id' direct=true
                        .say_this.say_body.f12
                            |!{content}
                        | {{when}}
                        div
                        // +skve k='view_section' v='main' l='main' i='content'
                        // +skve k='view_section' v='comments' l='comments' i='comment'
                        // +skve k='view_section' v='watson' l='emotion' i='dna'
                        // if tone
                        //     +skve k='view_section' v='tone' l='tone' i='smile grey'
                        // // +skve k='view_section' v='tags' l='tags' i='tags'
                        // +skve k='view_section' v='related' l='related' i='fork'
                        // +skve k='view_section' v='preview' l='preview' i='content'
                        // if skv_is 'view_section' 'main'
                        // if skv_is 'view_section' 'main'
                        if is_youtube
                            div
                            // .ui.fluid.embed
                            //     iframe(id="ytplayer" type="text/html" width="100%" height="500" src="https://www.youtube.com/embed/#{youtube_parse}" frameborder="0" allowfullscreen)
                            iframe(width="100%" height="600" src="https://www.youtube.com/embed/#{youtube_parse}?autoplay=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen)
                        div
                        // if watson.analyzed_text
                        //     .say.f12
                        //         |{{nl2br watson.analyzed_text}}
                        // iframe(width="100%" height="600" src="https://v.redd.it/9vk3khyb08e51/DASH_360.mp4?source=fallback" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen)
                        .spacer
                        // img(src=url)
                        // div(style='position:relative; padding-bottom:calc(125.00% + 44px)')
                        //     iframe(src='https://gfycat.com/ifr/MeanFatAmurratsnake' frameborder='0' scrolling='no' width='100%' height='100%' style='position:absolute;top:0;left:0;' allowfullscreen)
                        // .rounded
                        //     |!{embed}
                        // if skv_is 'view_section' 'watson'
                        // +watson_full
                        // if skv_is 'view_section' 'related'
                        if skv_is 'view_section' 'tone'
                            +tone
                            // +skve k='view_section' v='money' l='money' i='money'
                            // if skv_is 'view_section'
                        if skv_is 'view_section' 'preview'
                            iframe(width="100%" height="800" src=data.url frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen)        
                        // +convert
                        // .spacer
                        // if skv_is 'view_section' 'tags'
                        // if skv_is 'view_section' 'comments'
                            
                        div 
                        .spacer
                        .spacer
                        +comments
                        if watson
                            .scrolling
                                +watson_view
                                +watson_full
                .four.wide.column.scrolling
                    .ui.segmen
                        +voting_full
                        // div
                        // .ui.inline.grey.header {{from_now start_datetime}}
                        
                        if can_edit
                            a.ui.circular.icon.button.edit_post(href="/g/#{group}/p/#{_id}/edit" title='edit')
                                i.large.link.pencil.icon
                        div
                        span(title='views')
                            | #{views}
                            i.grey.eye.icon
                        +array_edit key='tags' label='tags' direct=true
                        // +voting_full
                        +link_view key='link' label='link' direct=true
    
                        +array_edit key='time_tags' label='time tags' icon='clock' direct=true
                        +array_edit key='location_tags' label='location tags' icon='marker' direct=true
                        // .ui.header #{data.domain}
                        .spacer
                        // a.ui.basic.button(href="https://www.reddit.com/user/#{author}" target='_window')
                        a.ui.basic.button.goto_ruser(href="/u/#{_author_username}")
                            i.user.outline.icon
                            |#{_author_username}
                        +call_watson id=_id key='content' mode='html'
                        if in_dev
                            +print_this
                        if watson
                            +doc_emotion
                        |#{tags.length}
                        each tags
                            +flat_tag_picker
                    .ui.label #{points}
                        
template(name='group_post_edit')
    with current_doc
        .ui.stackable.padded.grid
            .row
                .four.wide.column.scrolling
                    a.ui.icon.big.button(href="/g/#{group}/p/#{_id}" title='save')
                        i.checkmark.big.icon
                    .ui.inline.header 
                        i.pencil.icon
                        |edit group post
                    i.large.link.red.remove.icon.delete_post
                    +image_edit key='image_id' label='image' direct=true
                    div 
                    +array_edit key='tags' label='tags' direct=true
                    +link_edit key='link' label='link' direct=true
                    +array_edit key='time_tags' label='time tags' icon='clock' direct=true
                    +array_edit key='location_tags' label='location tags' icon='marker' direct=true
                    +raw_edit key='raw' label='raw' direct=true
                .twelve.wide.column.scrolling
                    +text_edit key='title' label='title' direct=true
                    +html_edit key='content' label='content' direct=true
                    +image_link_edit key='image_link' direct=true
                    +youtube_edit key='youtube_id' label='youtube id' direct=true
        
